---
title: "Science des données cours 3 : Statistiques explicatives"
output: html_notebook
---


# Import la base de données

ID	Baby number
 length	Length of baby (cm)	Scale
 Birthweight	Weight of baby (kg)	Scale
 headcirumference	Head Circumference	Scale
 Gestation	Gestation (weeks)	Scale
 smoker	Mother smokes 1 = smoker 0 = non-smoker	 Binary
 motherage	Maternal age	Scale
 mnocig	Number of cigarettes smoked per day by mother	Scale
 mheight	Mothers height (cm)	 Scale
 mppwt	Mothers pre-pregnancy weight (kg)	 Scale
 fage	Father's age	 Scale
fedyrs	Father’s years in education	Scale
 fnocig	Number of cigarettes smoked per day by father	Scale
 fheight	Father's height (kg)	 Scale
 lowbwt	Low birth weight, 0 = No and 1 = yes	 Binary
mage35	Mother over 35, 0 = No and 1 = yes	Binary

```{r}
(BDD<- read.csv("Birthweight_reduced_kg_R.csv"))
```


 
 # Comparaison poids naissance  tabac Maternel

## Décrire les données

### Tabac maternel

```{r}
table(BDD$smoker)

```

### Poids de naissance

```{r}
library(pander)
pander(summary(BDD$Birthweight))
```

 ### Croiser les deux 
 
```{r}
pander(
  by(
    BDD$Birthweight,
    BDD$smoker,
    summary
  )
)
```
 
 ### Représentation Graphique 
 
```{r, fig.height=2}
library(ggplot2)
ggplot(BDD, aes(x=factor(smoker),y = Birthweight, color = factor(smoker)))+
  geom_boxplot()+
  geom_jitter()+
  labs(x="Tabac de la mère",
       y = "Poids de\n naissance")+
  theme_minimal()+theme(legend.position = "none")


```
```{r}
IC<- function(x){
  
  smx<- sd(x)/sqrt(length(x))
 moyx<- mean(x)
 return(c("Moy"=moyx, "ICbas"= moyx-1.96*smx, "IChaut"= moyx+1.96*smx))
  }
IC(BDD$Birthweight)

by(data = BDD$Birthweight, INDICES = BDD$smoker, FUN = IC)
```
```{r}
t.test(BDD$Birthweight~BDD$smoker)

```

```{r}
chisq.test(table(BDD$smoker,BDD$mage>25))
```


```{r}
prop.table(table(BDD$smoker,BDD$mage>25),2)
```



```{r}

fit<-lm(Birthweight~mage,BDD)
fit

summary(fit)
```


```{r}

fit<-lm(Birthweight~Gestation,BDD)
fit

summary(fit)
```



```{r}

fit<-lm(Birthweight~Gestation+mage+mppwt+factor(smoker),BDD)
fit

summary(fit)
```
```{r}
fit<-lm(Birthweight~factor(smoker),BDD)
fit

summary(fit)
```


```{r}
fit<-glm(lowbwt~Gestation+mage+mppwt+factor(smoker),BDD,family = "binomial")
fit

summary(fit)
```


# Comparaison Low birth Weight  Maternal age

## Décrire les données

### Low birth Weight

```{r}
table(BDD$lowbwt)

```

### Age de la mère

```{r}
library(pander)
pander(summary(BDD$mage))
```

 ### Croiser les deux 
 
```{r}
pander(
  by(
    BDD$mage,
    BDD$lowbwt,
    summary
  )
)
```
 
 ### Représentation Graphique 
 
```{r}
library(ggplot2)
ggplot(BDD, aes(x=factor(lowbwt),y = mage, color = factor(lowbwt)))+
  geom_boxplot()+
  geom_jitter()+
  labs(x="Faible poids de\n naissance",
       y = "Age de la mère")+
  theme_minimal()+theme(legend.position = "none")


```
 
 
