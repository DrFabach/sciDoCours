---
title: "Cours 1"
output: html_notebook
---

# Description des données de santé

## Import de la base de données

Ceci est le script du cours

```{r}

```

```{r}
# CTRL+ALT+I = Nouveau chunk
```

```{r}
```

```{r}
BDD<- read.csv2("infert.csv")
BDD <- infert
BDD
```
Base de données présente de base dans R : [lien ici](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/infert.html) 
```{r}
head(BDD)
```


### Ecart R
- R utilise des packages qui comprennent des fonctions 

```{r}
# chargement d'une library
# base est chargée de base
library(base)
```


```{r}
# installation d'une librairie 
# install.packages("tidyverse")
```


```{r}
# chargement de la librairie
library(tidyverse)
```

- R dispose d'une aide intégrée

```{r}
#aide sur une librairie
?tidyverse
help(tidyverse)
```


```{r}
# aide sur une fonction
?read.csv2
```

- Les fonctions utilises des arguments

```{r}
read.csv2("infert.csv")
```


- R est un langage de programmation avec différents types d'objets

```{r}
# Ceci est un objet 

a<-1
1->a
# Deconseillé
a=1
```

```{r}
#Il peut être appelé par son nom 
a
```

```{r}
#Il peut être modifier par son nom
a<-2 
a
```

```{r}
# Il peut comprendre autre chose qu'une valeur unique 
a<- c("a","b","c")
a
# La fonction c() crée un vecteur
```


```{r}
# Les valeurs d'un vecteur peuvent être accédées par leur indice 
a[1]
# Accès à partir d'un vecteur
a[c(1,3)]

```
```{r}
BDD
```
### Le nom des objets 

- Eviter les caractères spéciaux, accents
- toujours commencer par une lettre 
- espace interdit
- certains noms qui sont déja utilisés

Deux façon traditionnelles : 
- Serpent : nom_de_la_variable
- chameau : nomDeLaVariable
nom.de.la.variable

```{r}
typeof(a)
str(a)
```


```{r}
# BDD est un data frame
BDD[1,1]
BDD[1,]
head(BDD[,1])

# Interogger variable
head(BDD$pooled.stratum)
```


========================================================


```{r}
# Analyse de la structure de BDD
(str(BDD))


(names(BDD))

```

## Modification des types de variables 

```{r}
# Changement de numérique en facteur
BDD$induced<-as.factor(BDD$induced)
head(BDD$induced)
```


```{r}
# Changement de numérique en facteur avec choix des modalités
BDD$induced<- factor(BDD$induced,  labels =  c("0","1","2 or more"))
head(BDD$induced)

```

```{r}
BDD$spontaneous<- as.factor(BDD$spontaneous)
```

```{r}
# Conversion de facteur en numérique
facteur<- as.factor(c(10,4,10,2,3,4,6,5,7,5,4,10,2))
as.numeric(as.character(facteur))

```


# Retour cours

# Variables quantitatives :
- moyenne
```{r}
mean(BDD$age, na.rm = TRUE)
```

- mediane
```{r}
median(BDD$age, na.rm = T)
```

- min
```{r}
min(BDD$age, na.rm = T)
```

- max 
```{r}
max(BDD$age, na.rm = T)
```

-range 
```{r}
range(BDD$age)


```

###############
### Ecart R ### 
############### 

```{r}
max(BDD$age)-min(BDD$age)
rangeAge<-range(BDD$age)
rangeAge[2]-rangeAge[1]
```


Fonction dans R

nomfonction <- function(arg1, arg2 = valeurParDefaut){

somme<- arg1+ arg2
# plusieurs opérations

return(somme)
}

```{r}

# Création de fonction :
etendu<- function(variable){
  minX<- min(variable, na.rm = T)
  maxX<- max(variable, na.rm = T)
  return(maxX-minX)
}
str(etendu)
etendu
etendu(BDD$age)

```
###########

- quartile
```{r}
# premier quantile
(quantile(BDD$age, 0.25))
#Troisième quantile
(quantile(BDD$age, 0.75))
#1er et 3eme quantiles
(quantile(BDD$age, c(0.25, 0.75)))

```
- Interval interquartile 
```{r}
IQR(BDD$age)
```



- Variance, écart type

```{r}
#Variance
(var(BDD$age, na.rm = T))

#écart-type
(sd(BDD$age, na.rm = T))

```


# Retour cours

# Variable Quali : 

- table effectifs
```{r}
table(BDD$education)
```

Astuce 

```{r results='asis'}
library(pander)
pander(table(BDD$education))
```


- table fréquence

```{r}
prop.table(table(BDD$education))
```



#### Ecart R ####

# Data Management

## Condition 
<,>,<=,>=,==

```{r}
# Application d'une condition
c(1:7)>5

# Recherche des valeurs supérieurs 
vecteur<-c(1:7)
vecteur[vecteur>5]

# Plutot utilisé ça
vecteur[which(vecteur>5)]

vecteur<- c(1,2,3,4,NA,7,8)
```

## Boucle

```{r}
for( i in 1: 10 ){
  
  print(i)
}
  
```

## Condition

```{r}
#fonction appliqué à un vecteur
##ifelse
pander(table(ifelse(BDD$age>25,">25","<25")))


# Condition en générale 
#if, else if et else

ageSup25<- function(x){
  if(x>25){
    return(">25")
  }else if(x==25){
    return("25")
  }  else{
    return("<25")
  }
  
}
ageSup25(45)

```


# Croisement de variable

## Quali Quali

- table effectif
```{r}
table(BDD$case, BDD$education)
```

-table proportions

```{r}
# Proportions en ligne

prop.table(table(BDD$case, BDD$education),1)

# Proportions en colonne
prop.table(table(BDD$case, BDD$education),2)



# Proportions globales
prop.table(table(BDD$case, BDD$education))

```


## Quanti-quali

- Par des conditions 

```{r}
# moyenne age groupe 1
mean(BDD$age[which(BDD$case==1)])


# moyenne age groupe 2
mean(BDD$age[which(BDD$case==0)])


# moyenne age groupe pas 1 
mean(BDD$age[which(!BDD$case==1)])

```

- Par la fonction by

```{r}
by(BDD$age, BDD$case, mean)
```

## Quanti Quanti

- correlation
```{r}
cor(BDD$age, BDD$parity)
```


# Données manquantes

Les donnéees manquantes sont noté NA dans R
```{r}
vecteur<- c(1,2,3,NA,5,6)
mean(vecteur)
mean(vecteur, na.rm = T)
```

- Calculer moyenne, médiane de vecteur


# TD : 
- Décrire l'ensemble des variables de la base
- Décrire les variables en fonctions du groupe


# A faire pour la semaine prochaine:

Prendre une base de données et décrire les données

## Données disponibles
 
 - librarie R
 - [Open data](https://datashare.nida.nih.gov/)

## Critères base de données

2 variables quantitatives 
2 variables qualitatives 

## Décrire les types de variable
## Décrire les différentes variables
## Croiser les variables d'interêt 
## Les présenter 

Bonus : Analyse reproductible



